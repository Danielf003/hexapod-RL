# hexapod-RL

## Что сделано:

- Процедурная генерация имитационной модель гексапода для MuJoCo (`scene_generation.py`);
- Пользовательская среда gymnasium, использующая данную модель и определяющая наблюдения, состояния и награду (`gym_env.py`);
- Контроллер траектории, по параметрам строящий целевую траекторию для каждой ноги (`traj_calculation.py`);
- Регуляторы по методу вычисленного момента, обеспечивающие движение каждой ноги по целевой траектории;
- Релизация алгоритма PPO для обучения агента в пользовательской среде с сохранением весов после обучения (`run_learning.py`);
- Скрипт для запуска инференса обученной модели из сохраненных весов (`run_inference.py`)

Видео с процессом обучения робота в среде: https://drive.google.com/file/d/1HmrFopj6eiJR3HXoNIeMYRlPINBgZl8L/view?usp=sharing

## Готовим среду без Docker

Для Windows рекомендуется скачать менеджер виртуальных сред по ссылке https://docs.conda.io/projects/conda/en/latest/user-guide/install/windows.html

Anaconda - полная версия с большим набором предустановленных пакетов, miniconda - минимумом пакетов, miniforge - минимум пакетов с более производительным менеджером зависимостей mamba.
- В Anaconda/miniconda/miniforge:

`conda env create -f env.yml`
, затем активировать ее в IDE.
- В miniforge с продвинутым менеджером:

`mamba env create -f env.yml`
, затем активировать ее в IDE.

## Готовим среду с Docker

Не готово. В файле requirements.txt список доп зависимостей для докера

## Использование
Для проверки имитационной модели в симуляторе MuJoCo запускаем `example_no_ml.py`. Валидный выход: появилось интерактивное окно симуляции. 

Для старта обучения запускаем `run_learning.py`. Если не находит файл hexapod.xml - запустите `scene_generation.py`. Валидный выход: появилось окно симуляции, в конце обучения окно с графиком суммарных вознаграждений по эпизодам.

Для старта инференса обученной модели запускаем `run_inference.py`. Если не находит файл hex.weights - запустите `run_learning.py`. Валидный выход: появилось окно симуляции, в конце валидации окно с графиком суммарных вознаграждений по эпизодам.

